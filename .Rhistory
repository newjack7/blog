topicNine <- topicNine %>% inner_join(lincsEvents)
topicNine <-  topicNine[!duplicated(topicNine$lincsID), ]
topicTen <- topicTen %>% inner_join(lincsEvents)
topicTen <-  topicTen[!duplicated(topicTen$lincsID), ]
#Join all the dataframes together
topics <- do.call("rbind", list(topicOne, topicTwo, topicThree, topicFour, topicFive, topicSix, topicSeven, topicEight, topicNine, topicTen))
#I write the result to CSV so I can read it more easily
write.csv(topics, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topics.csv")
#Remove digits from the topic term list
lincsTopicDigitFree <- lincsTopics %>% mutate(word = (str_replace(word, '^\\d+', "")))
View(lincsTopics)
#Remove digits from the topic term list
lincsTopicDigitFree <- lincsTopics %>% mutate(word = (str_replace(term, '^\\d+', "")))
#Creates List of top terms that belong to each topic
lincsTopDigitFree <- lincsTopicDigitFree %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopDigitFree %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#Remove digits from the topic term list
lincsTopicDigitFree <- lincsTopics %>% filter(term = '^\\d+')))
#Remove digits from the topic term list
lincsTopicDigitFree <- lincsTopics %>% filter(term = '^\\d+')
#Remove digits from the topic term list
lincsTopicDigitFree <- lincsTopics %>% filter(term !== '^\\d+')
#Remove digits from the topic term list
lincsTopicDigitFree <- lincsTopics %>% filter(term == '^\\d+')
#Creates List of top terms that belong to each topic
lincsTopDigitFree <- lincsTopicDigitFree %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopDigitFree %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
View(lincsTopicDigitFree)
View(lincsTopics)
#Remove digits from the topic term list
lincsTopicDigitFree <- lincsTopics %>% filter(grepl('^\\D', topic))
View(lincsTopDigitFree)
#Remove digits from the topic term list
lincsTopicDigitFree <- lincsTopics[-grep('^\\d+$', lincsTopics$term),]
#Remove digits from the topic term list
lincsTopicDigitFree <- lincsTopics
View(lincsTopicDigitFree)
lincsDTM <- lincsTotalTidy %>%
select(word, lincsID) %>%
count(word, lincsID) %>%
cast_dtm(lincsID, word, n)
lincsLDA <- LDA(lincsDTM, k = 10, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincs_top_terms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincs_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincs_top_terms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
View(lincsTotalTidy)
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- lincsTotalTidy %>% filter(word !%in% months)
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- lincsTotalTidy %>% filter(!word %in% months)
View(lincsDTM)
lincsDTM <- lincsTotalTidy %>%
select(word, lincsID) %>%
count(word, lincsID) %>%
cast_dtm(lincsID, word, n)
lincsLDA <- LDA(lincsDTM, k = 10, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincs_top_terms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincs_top_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincs_top_terms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
View(lincsTopTerms)
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- lincsTotalTidy %>% filter(!word %in% months)
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- lincsTotalTidy %>% filter(!word %in% months)
lincsDTM <- lincsDTM %>%
select(word, lincsID) %>%
count(word, lincsID) %>%
cast_dtm(lincsID, word, n)
lincsLDA <- LDA(lincsDTM, k = 10, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- lincsTotalTidy %>% filter(!word %in% months)
lincsDTM <- lincsDTM %>%
select(word, lincsID) %>%
count(word, lincsID) %>%
cast_dtm(lincsID, word, n)
lincsLDA <- LDA(lincsDTM, k = 5, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- lincsTotalTidy %>% filter(!word %in% months)
lincsDTM <- lincsDTM %>%
select(word, lincsID) %>%
count(word, lincsID) %>%
cast_dtm(lincsID, word, n)
lincsLDA <- LDA(lincsDTM, k = 7, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- lincsTotalTidy %>% filter(!word %in% months)
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, lincsID) %>%
count(word, lincsID) %>%
cast_dtm(lincsID, word, n)
lincsLDA <- LDA(lincsDTM, k = 21, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- lincsTotalTidy %>% filter(!word %in% months)
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, lincsID) %>%
count(word, lincsID) %>%
cast_dtm(lincsID, word, n)
lincsLDA <- LDA(lincsDTM, k = 14, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
View(lincsEventsTokens)
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- filter(lincsOCR, TYPE == 'EVENT')
lincsDTM <- lincsDTM %>%  select(QUOTE_TRANSCRIPTION, UUID)
lincsDTM <- lincsDTM %>% rename(word = QUOTE_TRANSCRIPTION)
lincsDTM <- lincsDTM %>% unnest_tokens(word, word)
lincsDTM <- lincsDTM %>% anti_join(stop_word)
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- filter(lincsOCR, TYPE == 'EVENT')
lincsDTM <- lincsDTM %>%  select(QUOTE_TRANSCRIPTION, UUID)
lincsDTM <- lincsDTM %>% rename(word = QUOTE_TRANSCRIPTION)
lincsDTM <- lincsDTM %>% unnest_tokens(word, word)
lincsDTM <- lincsDTM %>% anti_join(stop_words)
lincsDTM <- lincsDTM %>% filter(!word %in% months)
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, lincsID) %>%
count(word, lincsID) %>%
cast_dtm(lincsID, word, n)
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept")
lincsDTM <- filter(lincsOCR, TYPE == 'EVENT')
lincsDTM <- lincsDTM %>%  select(QUOTE_TRANSCRIPTION, UUID)
lincsDTM <- lincsDTM %>% rename(word = QUOTE_TRANSCRIPTION)
lincsDTM <- lincsDTM %>% unnest_tokens(word, word)
lincsDTM <- lincsDTM %>% anti_join(stop_words)
lincsDTM <- lincsDTM %>% filter(!word %in% months)
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, UUID) %>%
count(word, UUID) %>%
cast_dtm(UUID, word, n)
lincsLDA <- LDA(lincsDTM, k = 14, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept","john", "robert", "william", "thomas", "de")
#lincsNames <- c("john", "robert", "william", "thomas", "de", )
lincsDTM <- filter(lincsOCR, TYPE == 'EVENT')
lincsDTM <- lincsDTM %>%  select(QUOTE_TRANSCRIPTION, UUID)
lincsDTM <- lincsDTM %>% rename(word = QUOTE_TRANSCRIPTION)
lincsDTM <- lincsDTM %>% unnest_tokens(word, word)
lincsDTM <- lincsDTM %>% anti_join(stop_words)
lincsDTM <- lincsDTM %>% filter(!word %in% months)
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, UUID) %>%
count(word, UUID) %>%
cast_dtm(UUID, word, n)
lincsLDA <- LDA(lincsDTM, k = 14, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept","john", "robert", "william", "thomas", "de")
#lincsNames <- c("john", "robert", "william", "thomas", "de", )
lincsDTM <- filter(lincsOCR, TYPE == 'EVENT')
lincsDTM <- lincsDTM %>%  select(QUOTE_TRANSCRIPTION, UUID)
lincsDTM <- lincsDTM %>% rename(word = QUOTE_TRANSCRIPTION)
lincsDTM <- lincsDTM %>% unnest_tokens(word, word)
lincsDTM <- lincsDTM %>% anti_join(stop_words)
lincsDTM <- lincsDTM %>% filter(!word %in% months)
lincsDTM <- lincsDTM %>% filter(grepl('^\\D', word))
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, UUID) %>%
count(word, UUID) %>%
cast_dtm(UUID, word, n)
lincsLDA <- LDA(lincsDTM, k = 14, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept","john", "robert", "william", "thomas", "de", "edward", "richard", "â", "atte", "alan")
#lincsNames <- c("john", "robert", "william", "thomas", "de", )
lincsDTM <- filter(lincsOCR, TYPE == 'EVENT')
lincsDTM <- lincsDTM %>%  select(QUOTE_TRANSCRIPTION, UUID)
lincsDTM <- lincsDTM %>% rename(word = QUOTE_TRANSCRIPTION)
lincsDTM <- lincsDTM %>% unnest_tokens(word, word)
lincsDTM <- lincsDTM %>% anti_join(stop_words)
lincsDTM <- lincsDTM %>% filter(!word %in% months)
lincsDTM <- lincsDTM %>% filter(grepl('^\\D', word))
lincsDTM <- lincsDTM %>% anti_join(lincsPeople, by = 'word')
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, UUID) %>%
count(word, UUID) %>%
cast_dtm(UUID, word, n)
lincsLDA <- LDA(lincsDTM, k = 14, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept","john", "robert", "william", "thomas", "de", "edward", "richard", "â", "atte", "alan", "kingâ")
#lincsNames <- c("john", "robert", "william", "thomas", "de", )
lincsDTM <- filter(lincsOCR, TYPE == 'EVENT')
lincsDTM <- lincsDTM %>%  select(QUOTE_TRANSCRIPTION, UUID)
lincsDTM <- lincsDTM %>% rename(word = QUOTE_TRANSCRIPTION)
lincsDTM <- lincsDTM %>% unnest_tokens(word, word)
lincsDTM <- lincsDTM %>% anti_join(stop_words)
lincsDTM <- lincsDTM %>% filter(!word %in% months)
lincsDTM <- lincsDTM %>% filter(grepl('^\\D', word))
lincsDTM <- lincsDTM %>% anti_join(lincsPeople, by = 'word')
lincsDTM <- lincsDTM %>% anti_join(lincsPlaces, by = 'word')
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, UUID) %>%
count(word, UUID) %>%
cast_dtm(UUID, word, n)
lincsLDA <- LDA(lincsDTM, k = 14, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept","john", "robert", "william", "thomas", "de", "edward", "richard", "â", "atte", "alan", "kingâ")
#lincsNames <- c("john", "robert", "william", "thomas", "de", )
lincsDTM <- filter(lincsOCR, TYPE == 'EVENT')
lincsDTM <- lincsDTM %>%  select(QUOTE_TRANSCRIPTION, UUID)
lincsDTM <- lincsDTM %>% rename(word = QUOTE_TRANSCRIPTION)
lincsDTM <- lincsDTM %>% unnest_tokens(word, word)
lincsDTM <- lincsDTM %>% anti_join(stop_words)
lincsDTM <- lincsDTM %>% filter(!word %in% months)
lincsDTM <- lincsDTM %>% filter(grepl('^\\D', word))
lincsDTM <- lincsDTM %>% anti_join(lincsPeople, by = 'word')
lincsDTM <- lincsDTM %>% anti_join(lincsPlaces, by = 'word')
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, UUID) %>%
count(word, UUID) %>%
cast_dtm(UUID, word, n)
lincsLDA <- LDA(lincsDTM, k = 10, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept","john", "robert", "william", "thomas", "de", "edward", "richard", "â", "atte", "alan", "kingâ")
#lincsNames <- c("john", "robert", "william", "thomas", "de", )
lincsDTM <- filter(lincsOCR, TYPE == 'EVENT')
lincsDTM <- lincsDTM %>%  select(QUOTE_TRANSCRIPTION, UUID)
lincsDTM <- lincsDTM %>% rename(word = QUOTE_TRANSCRIPTION)
lincsDTM <- lincsDTM %>% unnest_tokens(word, word)
lincsDTM <- lincsDTM %>% anti_join(stop_words)
lincsDTM <- lincsDTM %>% filter(!word %in% months)
lincsDTM <- lincsDTM %>% filter(grepl('^\\D', word))
lincsDTM <- lincsDTM %>% anti_join(lincsPeople, by = 'word')
lincsDTM <- lincsDTM %>% anti_join(lincsPlaces, by = 'word')
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, UUID) %>%
count(word, UUID) %>%
cast_dtm(UUID, word, n)
lincsLDA <- LDA(lincsDTM, k = 8, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
months <- c("january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december", "jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec", "sept","john", "robert", "william", "thomas", "de", "edward", "richard", "â", "atte", "alan", "kingâ")
#lincsNames <- c("john", "robert", "william", "thomas", "de", )
lincsDTM <- filter(lincsOCR, TYPE == 'EVENT')
lincsDTM <- lincsDTM %>%  select(QUOTE_TRANSCRIPTION, UUID)
lincsDTM <- lincsDTM %>% rename(word = QUOTE_TRANSCRIPTION)
lincsDTM <- lincsDTM %>% unnest_tokens(word, word)
lincsDTM <- lincsDTM %>% anti_join(stop_words)
lincsDTM <- lincsDTM %>% filter(!word %in% months)
lincsDTM <- lincsDTM %>% filter(grepl('^\\D', word))
lincsDTM <- lincsDTM %>% anti_join(lincsPeople, by = 'word')
lincsDTM <- lincsDTM %>% anti_join(lincsPlaces, by = 'word')
#Cast into DTM and run the topic model
lincsDTM <- lincsDTM %>%
select(word, UUID) %>%
count(word, UUID) %>%
cast_dtm(UUID, word, n)
lincsLDA <- LDA(lincsDTM, k = 12, control = list(seed = 1234))
lincsTopics <- tidy(lincsLDA, matrix = "beta")
lincsTopics
#Creates List of top terms that belong to each topic
lincsTopTerms <- lincsTopics %>%
group_by(topic) %>%
top_n(10, beta) %>%
ungroup() %>%
arrange(topic, -beta)
#Visualises the top terms
lincsTopTerms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
#write.csv(lincsTopTerms, "C:\\Users\\Jack\\Documents\\GitHub\\blog\\Lincolnshire csv Data\\topicModeltop20.csv")
